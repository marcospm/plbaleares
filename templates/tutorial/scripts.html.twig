<script>
// Definir funciones inmediatamente para que estén disponibles cuando se ejecuten los onclick
(function() {
    'use strict';
    
    // Función para toggle de secciones
    window.toggleSection = function(sectionId) {
        const section = document.getElementById(sectionId);
        if (!section) {
            console.warn('Sección no encontrada:', sectionId);
            return;
        }
        
        const wasActive = section.classList.contains('active');
        section.classList.toggle('active');
        
        // Forzar reflow para asegurar que la animación se ejecute
        void section.offsetHeight;
        
        // Si se está abriendo, asegurar que el contenido sea visible
        if (!wasActive) {
            const content = section.querySelector('.tutorial-section-content');
            if (content) {
                content.style.maxHeight = content.scrollHeight + 'px';
            }
        }
    };

    // Función para toggle de subsecciones
    window.toggleSubsection = function(subsectionId) {
        const subsection = document.getElementById(subsectionId);
        if (!subsection) {
            console.warn('Subsección no encontrada:', subsectionId);
            return;
        }
        
        const wasActive = subsection.classList.contains('active');
        subsection.classList.toggle('active');
        
        // Forzar reflow para asegurar que la animación se ejecute
        void subsection.offsetHeight;
        
        // Si se está abriendo, asegurar que el contenido sea visible
        if (!wasActive) {
            const content = subsection.querySelector('.subsection-content');
            if (content) {
                content.style.maxHeight = content.scrollHeight + 'px';
            }
        }
    };

    // Función para abrir una sección específica
    window.openSection = function(sectionId) {
        const section = document.getElementById(sectionId);
        if (section) {
            if (!section.classList.contains('active')) {
                section.classList.add('active');
                const content = section.querySelector('.tutorial-section-content');
                if (content) {
                    content.style.maxHeight = content.scrollHeight + 'px';
                }
            }
            // Scroll suave a la sección
            setTimeout(() => {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }
    };

    // Función para expandir/colapsar todas las secciones
    window.toggleAllSections = function() {
        const sections = document.querySelectorAll('.tutorial-section');
        const subsections = document.querySelectorAll('.subsection');
        const allExpanded = Array.from(sections).every(s => s.classList.contains('active'));
        
        sections.forEach(section => {
            if (allExpanded) {
                section.classList.remove('active');
                const content = section.querySelector('.tutorial-section-content');
                if (content) {
                    content.style.maxHeight = '0';
                }
            } else {
                section.classList.add('active');
                const content = section.querySelector('.tutorial-section-content');
                if (content) {
                    content.style.maxHeight = content.scrollHeight + 'px';
                }
            }
        });
        
        // También expandir/colapsar todas las subsecciones
        subsections.forEach(subsection => {
            if (allExpanded) {
                subsection.classList.remove('active');
                const content = subsection.querySelector('.subsection-content');
                if (content) {
                    content.style.maxHeight = '0';
                }
            } else {
                subsection.classList.add('active');
                const content = subsection.querySelector('.subsection-content');
                if (content) {
                    content.style.maxHeight = content.scrollHeight + 'px';
                }
            }
        });
    };

    // Función para inicializar
    function initTutorial() {
        const firstSection = document.getElementById('seccion-1');
        if (firstSection && !firstSection.classList.contains('active')) {
            firstSection.classList.add('active');
            const content = firstSection.querySelector('.tutorial-section-content');
            if (content) {
                content.style.maxHeight = content.scrollHeight + 'px';
            }
        }
    }

    // Ejecutar cuando el DOM esté listo
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initTutorial);
    } else {
        initTutorial();
    }
})();
</script>

