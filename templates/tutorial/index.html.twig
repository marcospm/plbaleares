{% extends 'base.html.twig' %}

{% block title %}Tutorial de la Plataforma{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .tutorial-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        .tutorial-section {
            background: white;
            border-radius: 8px;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid var(--color-primary);
            overflow: hidden;
        }
        
        .tutorial-section-header {
            padding: 1.25rem 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            transition: background-color 0.2s ease;
            user-select: none;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
            touch-action: manipulation;
        }
        
        .tutorial-section-header:hover,
        .tutorial-section-header:active {
            background-color: #f8f9fa;
        }
        
        @media (hover: none) {
            .tutorial-section-header:active {
                background-color: #e9ecef;
            }
        }
        
        .tutorial-section-header h2 {
            margin: 0;
            flex: 1;
            color: var(--color-primary);
            font-size: 1.5rem;
        }
        
        .tutorial-section-content {
            padding: 0 1.5rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }
        
        .tutorial-section.active .tutorial-section-content {
            padding: 1.5rem;
            max-height: 10000px;
        }
        
        .accordion-icon {
            font-size: 1.2rem;
            color: var(--color-primary);
            transition: transform 0.3s ease;
            margin-left: 1rem;
        }
        
        .tutorial-section.active .accordion-icon {
            transform: rotate(180deg);
        }
        
        .tutorial-section h3 {
            color: #333;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            font-size: 1.4rem;
        }
        
        .tutorial-section h4 {
            color: #555;
            margin-top: 1rem;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }
        
        .step-box {
            background: #f8f9fa;
            border-left: 3px solid var(--color-primary);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        
        .step-box strong {
            color: var(--color-primary);
        }
        
        .feature-card {
            background: #f0f7ff;
            border: 1px solid #b3d9ff;
            border-radius: 6px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .feature-card h4 {
            color: var(--color-primary);
            margin-top: 0;
        }
        
        .icon-large {
            font-size: 2rem;
            margin-right: 0.5rem;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 0.75rem 1rem;
            border-left: 3px solid #ffc107;
            margin: 1rem 0;
            border-radius: 4px;
        }
        
        .tip {
            background: #d1ecf1;
            padding: 0.75rem 1rem;
            border-left: 3px solid #0c5460;
            margin: 1rem 0;
            border-radius: 4px;
        }
        
        .warning {
            background: #f8d7da;
            padding: 0.75rem 1rem;
            border-left: 3px solid #dc3545;
            margin: 1rem 0;
            border-radius: 4px;
        }
        
        ul.feature-list {
            list-style: none;
            padding-left: 0;
        }
        
        ul.feature-list li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }
        
        ul.feature-list li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--color-primary);
            font-weight: bold;
        }
        
        .menu-structure {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .menu-structure ul {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }
        
        .toc {
            background: #f8f9fa;
            border: 2px solid var(--color-primary);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .toc h3 {
            margin-top: 0;
            color: var(--color-primary);
        }
        
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        
        .toc li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
        }
        
        .toc a {
            color: var(--color-primary);
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        .expand-all-btn {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 1rem;
            font-weight: 500;
            transition: background-color 0.2s ease;
        }
        
        .expand-all-btn:hover {
            background: #1976d2;
        }
        
        /* Estilos para subsecciones plegables */
        .subsection {
            margin: 1rem 0;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            background: #fafafa;
        }
        
        .subsection-header {
            padding: 0.75rem 1rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            transition: background-color 0.2s ease;
            user-select: none;
            border-bottom: 1px solid #e0e0e0;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
            touch-action: manipulation;
        }
        
        .subsection-header:hover,
        .subsection-header:active {
            background-color: #f5f5f5;
        }
        
        @media (hover: none) {
            .subsection-header:active {
                background-color: #e9ecef;
            }
        }
        
        .subsection-header h3,
        .subsection-header h4 {
            margin: 0;
            flex: 1;
            color: #333;
            font-size: 1.2rem;
        }
        
        .subsection-header h4 {
            font-size: 1rem;
        }
        
        .subsection-content {
            padding: 0 1rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
            background: white;
        }
        
        .subsection.active .subsection-content {
            padding: 1rem;
            max-height: 10000px;
        }
        
        .subsection-icon {
            font-size: 0.9rem;
            color: #666;
            transition: transform 0.3s ease;
            margin-left: 0.5rem;
        }
        
        .subsection.active .subsection-icon {
            transform: rotate(180deg);
        }
    </style>
{% endblock %}

{% block body %}
<div class="tutorial-container">
    {# INTRODUCCI√ìN #}
    <div class="tutorial-section" style="border: none; box-shadow: none; background: transparent;">
        <h1 style="color: var(--color-primary); margin-bottom: 0.5rem;">
            <span class="icon-large">üìö</span>
            Tutorial de la Plataforma
        </h1>
        <p style="font-size: 1.1rem; color: #666; margin-bottom: 1rem;">
            Bienvenido a la plataforma de preparaci√≥n para oposiciones de Polic√≠a Local de Illes Balears. 
            Este tutorial te guiar√° paso a paso para que puedas aprovechar al m√°ximo todas las funcionalidades disponibles.
        </p>
        <p style="font-size: 0.95rem; color: #888; font-style: italic;">
            üí° Haz clic en cada secci√≥n para desplegarla y leer el contenido. Puedes expandir o colapsar las secciones seg√∫n necesites.
        </p>
    </div>

    {# TABLA DE CONTENIDOS #}
    <div class="toc">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h3 style="margin: 0;">üìë Tabla de Contenidos</h3>
            <button class="expand-all-btn" onclick="toggleAllSections()">Expandir/Colapsar Todo</button>
        </div>
        <ul>
            <li><a href="#" onclick="openSection('seccion-1'); return false;">1. El Men√∫ de Navegaci√≥n</a></li>
            <li><a href="#" onclick="openSection('seccion-2'); return false;">2. Dashboard (Inicio)</a></li>
            <li><a href="#" onclick="openSection('seccion-3'); return false;">3. Planificaci√≥n</a></li>
            <li><a href="#" onclick="openSection('seccion-4'); return false;">4. Ex√°menes</a></li>
            <li><a href="#" onclick="openSection('seccion-5'); return false;">5. Art√≠culos</a></li>
            <li><a href="#" onclick="openSection('seccion-6'); return false;">6. Temario y Recursos</a></li>
            <li><a href="#" onclick="openSection('seccion-7'); return false;">7. BOIB</a></li>
            <li><a href="#" onclick="openSection('seccion-8'); return false;">8. Notificaciones</a></li>
            <li><a href="#" onclick="openSection('seccion-9'); return false;">9. Mensajes al Profesor</a></li>
            <li><a href="#" onclick="openSection('seccion-10'); return false;">10. Contacto</a></li>
            <li><a href="#" onclick="openSection('seccion-11'); return false;">11. Consejos y Preguntas Frecuentes</a></li>
        </ul>
    </div>

    {# SECCI√ìN 1: MEN√ö DE NAVEGACI√ìN #}
    <div class="tutorial-section" id="seccion-1">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-1')">
            <h2><span class="icon-large">üß≠</span> 1. El Men√∫ de Navegaci√≥n</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            En la parte superior de la p√°gina encontrar√°s el men√∫ principal con todas las secciones disponibles. 
            El men√∫ est√° organizado de la siguiente manera:
        </p>
        
        <div class="menu-structure">
            <h4>Estructura del Men√∫ Principal:</h4>
            <ul>
                <li><strong>Inicio:</strong> Te lleva al Dashboard (tu p√°gina principal)</li>
                <li><strong>Planificaci√≥n:</strong> Tu planificaci√≥n personalizada de estudio</li>
                <li><strong>Ex√°menes:</strong> Men√∫ desplegable con:
                    <ul>
                        <li>üìù Ex√°menes (ex√°menes normales)</li>
                        <li>üìÖ Ex√°menes Semanales</li>
                        <li>üìä Historial de Ex√°menes</li>
                        <li>üë• Historial de Ex√°menes del Grupo (si perteneces a un grupo)</li>
                    </ul>
                </li>
                <li><strong>Art√≠culos:</strong> Recursos de estudio y novedades</li>
                <li><strong>Temario y Recursos:</strong> Material de estudio completo</li>
                <li><strong>BOIB:</strong> Informaci√≥n del bolet√≠n oficial</li>
                <li><strong>Contacto:</strong> Para enviar mensajes generales</li>
            </ul>
        </div>
        
        <div class="tip">
            <strong>üí° Tip:</strong> En la parte superior derecha tambi√©n encontrar√°s:
            <ul class="feature-list">
                <li>üîî <strong>Notificaciones:</strong> Icono con contador de notificaciones no le√≠das</li>
                <li>Tu nombre de usuario y rol (Alumno/Profesor/Admin)</li>
                <li>Bot√≥n para cerrar sesi√≥n</li>
            </ul>
        </div>
        </div>
    </div>

    {# SECCI√ìN 2: DASHBOARD #}
    <div class="tutorial-section" id="seccion-2">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-2')">
            <h2><span class="icon-large">üè†</span> 2. Dashboard (Inicio)</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            El Dashboard es tu p√°gina principal al iniciar sesi√≥n. Es tu centro de control donde encontrar√°s 
            un resumen completo de toda tu actividad y estado en la plataforma.
        </p>
        
        <div class="subsection" id="sub-2-1">
            <div class="subsection-header" onclick="toggleSubsection('sub-2-1')">
                <h3>2.1. Profesor Asignado y Grupos</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <div class="feature-card">
                    <p>
                        En la parte superior del Dashboard ver√°s informaci√≥n sobre tu profesor asignado. 
                        Si perteneces a un grupo, tambi√©n ver√°s el nombre de tu grupo.
                    </p>
                    <ul class="feature-list">
                        <li>Nombre del profesor asignado</li>
                        <li>Nombre del grupo (si perteneces a uno)</li>
                        <li>Bot√≥n "Enviar Mensaje" para contactar con tu profesor</li>
                    </ul>
                </div>
                
                <div class="warning">
                    <strong>‚ö†Ô∏è Sin Profesor:</strong> Si no tienes profesor asignado, ver√°s un aviso. 
                    Contacta con el administrador para que te asigne uno. Muchas funcionalidades requieren un profesor asignado.
                </div>
            </div>
        </div>
        
        <div class="subsection" id="sub-2-2">
            <div class="subsection-header" onclick="toggleSubsection('sub-2-2')">
                <h3>2.2. Mi Planificaci√≥n (Resumen)</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <div class="feature-card">
                    <h4>Actividades de Hoy y Ma√±ana</h4>
                    <p>
                        Esta secci√≥n muestra un resumen de las actividades programadas para <strong>hoy</strong> y <strong>ma√±ana</strong>:
                    </p>
                    <ul class="feature-list">
                        <li>Franjas horarias de estudio o repaso</li>
                        <li>Horarios espec√≠ficos (hora de inicio y fin)</li>
                        <li>Tipo de actividad (Estudio o Repaso)</li>
                        <li>Descripci√≥n de qu√© estudiar (si est√° disponible)</li>
                        <li>Enlace para ver tu planificaci√≥n completa</li>
                    </ul>
                </div>
                
                <div class="step-box">
                    <strong>Para ver tu planificaci√≥n completa:</strong> Haz clic en "Ver Planificaci√≥n Completa" 
                    o ve al men√∫ "Planificaci√≥n".
                </div>
            </div>
        </div>
        
        <div class="subsection" id="sub-2-3">
            <div class="subsection-header" onclick="toggleSubsection('sub-2-3')">
                <h3>2.3. Mis Tareas</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <div class="feature-card">
                    <p>
                        Aqu√≠ ver√°s las tareas que tu profesor te ha asignado. Puedes:
                    </p>
                    <ul class="feature-list">
                        <li>Ver todas tus tareas pendientes</li>
                        <li>Ver tareas completadas</li>
                        <li>Marcar tareas como completadas cuando las termines</li>
                        <li>Ver detalles de cada tarea</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="subsection" id="sub-2-4">
            <div class="subsection-header" onclick="toggleSubsection('sub-2-4')">
                <h3>2.4. Rankings y Estad√≠sticas</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <div class="feature-card">
                    <h4>Rankings del Temario General</h4>
                    <p>
                        Puedes ver rankings por dificultad (F√°cil, Moderada, Dif√≠cil) calculados con los √∫ltimos N ex√°menes. 
                        Puedes configurar cu√°ntos ex√°menes se usan para el c√°lculo.
                    </p>
                    <ul class="feature-list">
                        <li>Ver tu posici√≥n en cada ranking</li>
                        <li>Ver tu nota media</li>
                        <li>Filtrar por tema espec√≠fico</li>
                        <li>Ver el ranking completo con otros opositores (nombres ofuscados para privacidad)</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <h4>Rankings por Convocatoria</h4>
                    <p>
                        Si est√°s asignado a una convocatoria, tambi√©n ver√°s rankings espec√≠ficos de esa convocatoria:
                    </p>
                    <ul class="feature-list">
                        <li>Rankings por dificultad dentro de la convocatoria</li>
                        <li>Filtrar por municipio espec√≠fico</li>
                        <li>Ver tu posici√≥n en cada ranking</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="subsection" id="sub-2-5">
            <div class="subsection-header" onclick="toggleSubsection('sub-2-5')">
                <h3>2.5. Mis Convocatorias</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <div class="feature-card">
                    <p>
                        Si est√°s asignado a alguna convocatoria, ver√°s informaci√≥n detallada:
                    </p>
                    <ul class="feature-list">
                        <li>Nombre de la convocatoria</li>
                        <li>Municipios incluidos</li>
                        <li>Fecha del examen te√≥rico y d√≠as restantes</li>
                        <li>Fecha de las pruebas f√≠sicas y d√≠as restantes</li>
                        <li>Fecha del psicot√©cnico y d√≠as restantes</li>
                        <li>Estado de la convocatoria (Activa/Inactiva)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="tip">
            <strong>üí° Tip:</strong> Las secciones del Dashboard se pueden expandir y colapsar haciendo clic en el encabezado. 
            Tu preferencia se guarda autom√°ticamente.
        </div>
        </div>
    </div>

    {# SECCI√ìN 3: PLANIFICACI√ìN #}
    <div class="tutorial-section" id="seccion-3">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-3')">
            <h2><span class="icon-large">üìã</span> 3. Planificaci√≥n</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            La planificaci√≥n te ayuda a organizar tu tiempo de estudio de forma eficiente. 
            Tu profesor crea planificaciones personalizadas para ti con horarios y actividades espec√≠ficas.
        </p>
        
        <div class="subsection" id="sub-3-1">
            <div class="subsection-header" onclick="toggleSubsection('sub-3-1')">
                <h3>3.1. Acceder a tu Planificaci√≥n</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <div class="step-box">
                    <strong>Paso 1:</strong> Ve al men√∫ y selecciona "Planificaci√≥n"<br>
                    <strong>Paso 2:</strong> Ver√°s un calendario semanal con todas tus actividades<br>
                    <strong>Paso 3:</strong> Puedes navegar entre semanas usando las flechas de navegaci√≥n<br>
                    <strong>Paso 4:</strong> Haz clic en un d√≠a espec√≠fico para ver m√°s detalles
                </div>
            </div>
        </div>
        
        <div class="subsection" id="sub-3-2">
            <div class="subsection-header" onclick="toggleSubsection('sub-3-2')">
                <h3>3.2. Tipos de Actividades en la Planificaci√≥n</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <div class="feature-card">
                    <h4>üìÖ Franjas Horarias</h4>
                    <p>
                        Son per√≠odos de tiempo asignados para diferentes actividades. Cada franja tiene:
                    </p>
                    <ul class="feature-list">
                        <li><strong>Hora de inicio y fin:</strong> El per√≠odo espec√≠fico del d√≠a</li>
                        <li><strong>Tipo de actividad:</strong> Puede ser uno de tres tipos:
                            <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                                <li><strong>üìö Repaso B√°sico</strong> (color azul): Para repasar conceptos espec√≠ficos</li>
                                <li><strong>üìñ Estudio</strong> (color verde): Para estudiar nuevos temas o realizar tareas</li>
                                <li><strong>üìù Realizar Ex√°menes</strong> (color naranja): Tiempo dedicado espec√≠ficamente a realizar ex√°menes de pr√°ctica</li>
                            </ul>
                        </li>
                        <li><strong>Descripci√≥n:</strong> Qu√© estudiar, repasar o qu√© tipo de examen realizar (opcional)</li>
                    </ul>
                </div>
                
                <div class="tip">
                    <strong>üí° Colores en el Calendario:</strong>
                    <ul class="feature-list">
                        <li><span style="color: #2196F3; font-weight: bold;">Azul</span> = Repaso B√°sico</li>
                        <li><span style="color: #4CAF50; font-weight: bold;">Verde</span> = Estudio</li>
                        <li><span style="color: #FF9800; font-weight: bold;">Naranja</span> = Realizar Ex√°menes</li>
                    </ul>
                    Estos colores te ayudan a identificar r√°pidamente qu√© tipo de actividad tienes programada.
                </div>
                
                <div class="feature-card">
                    <h4>üìù Tareas Asignadas</h4>
                    <p>
                        Son tareas espec√≠ficas que tu profesor te asigna. Pueden ser:
                    </p>
                    <ul class="feature-list">
                        <li>Estudiar un tema espec√≠fico</li>
                        <li>Realizar un examen</li>
                        <li>Revisar un art√≠culo</li>
                        <li>Cualquier otra actividad de estudio</li>
                    </ul>
                    <p style="margin-top: 0.5rem;">
                        <strong>Gesti√≥n de tareas:</strong> Puedes marcar las tareas como completadas cuando las termines. 
                        Esto ayuda a tu profesor a hacer seguimiento de tu progreso.
                    </p>
                </div>
                
                <div class="highlight">
                    <strong>üìå Importante:</strong> La planificaci√≥n en el Dashboard solo muestra hoy y ma√±ana. 
                    Para ver tu planificaci√≥n completa de todas las semanas, ve a la secci√≥n "Planificaci√≥n" del men√∫.
                </div>
                
                <div class="tip">
                    <strong>üí° Consejo:</strong> Intenta seguir tu planificaci√≥n lo m√°s fielmente posible. 
                    Est√° dise√±ada para optimizar tu tiempo de estudio y ayudarte a prepararte de forma eficiente.
                </div>
            </div>
        </div>
        </div>
    </div>

    {# SECCI√ìN 4: EX√ÅMENES #}
    <div class="tutorial-section" id="seccion-4">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-4')">
            <h2><span class="icon-large">üìù</span> 4. Ex√°menes</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            Los ex√°menes son una de las funcionalidades m√°s importantes de la plataforma. Te permiten practicar 
            y evaluar tu conocimiento de forma similar a como ser√° el examen real.
        </p>
        
        <div class="subsection" id="sub-4-1">
            <div class="subsection-header" onclick="toggleSubsection('sub-4-1')">
                <h3>4.1. Ex√°menes Normales</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <p>
                    Los ex√°menes normales son pruebas que puedes realizar cuando quieras, sin restricciones de tiempo 
                    (excepto el tiempo que tardes en completarlos).
                </p>
                
                <div class="step-box">
                    <strong>Paso 1:</strong> Ve al men√∫ "Ex√°menes" ‚Üí "Ex√°menes"<br>
                    <strong>Paso 2:</strong> Elige el tipo de examen:
                    <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                        <li><strong>Temario General:</strong> Ex√°menes sobre todos los temas del temario</li>
                        <li><strong>Municipal:</strong> Ex√°menes espec√≠ficos de un municipio</li>
                        <li><strong>Convocatoria:</strong> Ex√°menes relacionados con una convocatoria espec√≠fica</li>
                    </ul>
                    <strong>Paso 3:</strong> Configura el examen:
                    <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                        <li>Selecciona la dificultad (F√°cil, Moderada, Dif√≠cil)</li>
                        <li>Elige el n√∫mero de preguntas</li>
                        <li>Si es temario general, puedes seleccionar temas espec√≠ficos</li>
                        <li>Si es municipal, selecciona el municipio</li>
                        <li>Si es convocatoria, selecciona la convocatoria</li>
                    </ul>
                    <strong>Paso 4:</strong> Haz clic en "Iniciar Examen"<br>
                    <strong>Paso 5:</strong> Responde las preguntas. Puedes navegar entre ellas usando los n√∫meros peque√±os en la parte superior<br>
                    <strong>Paso 6:</strong> Al finalizar, ver√°s tus resultados: nota, aciertos, errores y preguntas en blanco<br>
                    <strong>Paso 7:</strong> Puedes ver el detalle de cada pregunta, tu respuesta y la respuesta correcta
                </div>
                
                <div class="tip">
                    <strong>üí° Sistema de Puntuaci√≥n:</strong>
                    <ul class="feature-list">
                        <li>Las preguntas en blanco no suman ni restan puntos</li>
                        <li>Cada acierto suma puntos (20 dividido entre el n√∫mero total de preguntas)</li>
                        <li>Cada 4 errores restan el equivalente a 1 acierto</li>
                        <li>La nota m√°xima es 20</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="subsection" id="sub-4-2">
            <div class="subsection-header" onclick="toggleSubsection('sub-4-2')">
                <h3>4.2. Ex√°menes Semanales</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <p>
                    Los ex√°menes semanales son pruebas programadas por tu profesor con fechas de apertura y cierre espec√≠ficas.
                </p>
                
                <div class="feature-card">
                    <h4>Caracter√≠sticas de los Ex√°menes Semanales:</h4>
                    <ul class="feature-list">
                        <li>Tienen una fecha de apertura (cu√°ndo se pueden empezar a realizar)</li>
                        <li>Tienen una fecha de cierre (hasta cu√°ndo se pueden realizar)</li>
                        <li>Pueden ser de tipo general, municipal o de convocatoria</li>
                        <li>Algunos ex√°menes pueden estar asignados a grupos espec√≠ficos</li>
                        <li>Puedes realizarlos en cualquier momento dentro del per√≠odo de apertura</li>
                        <li>Tienen su propio ranking con todos los alumnos que lo han realizado</li>
                    </ul>
                </div>
                
                <div class="step-box">
                    <strong>Para realizar un examen semanal:</strong>
                    <ol style="padding-left: 1.5rem;">
                        <li>Ve a "Ex√°menes" ‚Üí "Ex√°menes Semanales"</li>
                        <li>Ver√°s los ex√°menes disponibles (los que est√°n dentro de su per√≠odo de apertura)</li>
                        <li>Haz clic en "Realizar Examen Online"</li>
                        <li>Completa el examen igual que un examen normal</li>
                        <li>Al finalizar, tus resultados se guardan autom√°ticamente</li>
                    </ol>
                </div>
            </div>
        </div>
        
        <div class="subsection" id="sub-4-3">
            <div class="subsection-header" onclick="toggleSubsection('sub-4-3')">
                <h3>4.3. Ex√°menes PDF</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <p>
                    Si has realizado un examen en formato PDF (impreso), puedes introducir tus resultados manualmente 
                    para que se registren en tu historial.
                </p>
                
                <div class="step-box">
                    <strong>Para introducir resultados de un PDF:</strong>
                    <ol style="padding-left: 1.5rem;">
                        <li>Ve al examen semanal correspondiente</li>
                        <li>Haz clic en "Introducir Resultados PDF" o "Editar Resultados PDF"</li>
                        <li>Introduce tu nota, aciertos, errores y preguntas en blanco</li>
                        <li>Guarda los resultados</li>
                    </ol>
                </div>
                
                <div class="tip">
                    <strong>üí° Tip:</strong> Los resultados de ex√°menes PDF tambi√©n se incluyen en tu historial y 
                    en los c√°lculos de rankings y estad√≠sticas.
                </div>
            </div>
        </div>
        
        <div class="subsection" id="sub-4-4">
            <div class="subsection-header" onclick="toggleSubsection('sub-4-4')">
                <h3>4.4. Historial de Ex√°menes</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <p>
                    En el historial puedes ver todos los ex√°menes que has realizado, con sus resultados detallados.
                </p>
                
                <div class="feature-card">
                    <h4>Funcionalidades del Historial:</h4>
                    <ul class="feature-list">
                        <li>Ver todos tus ex√°menes ordenados por fecha (m√°s recientes primero)</li>
                        <li>Filtrar por tema (para ex√°menes del temario general)</li>
                        <li>Filtrar por convocatoria y municipio</li>
                        <li>Ver rankings y tu posici√≥n en ellos</li>
                        <li>Ver detalles de cada examen (preguntas, respuestas, resultados)</li>
                        <li>Paginaci√≥n para navegar entre muchos ex√°menes</li>
                    </ul>
                </div>
                
                <div class="step-box">
                    <strong>Para acceder al historial:</strong>
                    <ol style="padding-left: 1.5rem;">
                        <li>Ve a "Ex√°menes" ‚Üí "Historial de Ex√°menes"</li>
                        <li>Ver√°s tus ex√°menes separados por tipo (Temario General y por Convocatoria)</li>
                        <li>Puedes filtrar y configurar los rankings</li>
                        <li>Haz clic en "Ver Detalle" de cualquier examen para ver todas las preguntas y respuestas</li>
                    </ol>
                </div>
            </div>
        </div>
        
        <div class="subsection" id="sub-4-5">
            <div class="subsection-header" onclick="toggleSubsection('sub-4-5')">
                <h3>4.5. Historial de Ex√°menes del Grupo</h3>
                <span class="subsection-icon">‚ñº</span>
            </div>
            <div class="subsection-content">
                <div class="feature-card">
                    <p>
                        Si perteneces a un grupo, tambi√©n puedes ver el historial completo de todos los alumnos del grupo:
                    </p>
                    <ul class="feature-list">
                        <li>Ver todos los ex√°menes realizados por los miembros del grupo</li>
                        <li>Comparar resultados con tus compa√±eros</li>
                        <li>Ver rankings del grupo</li>
                        <li>Identificar a cada alumno por su nombre</li>
                    </ul>
                </div>
                
                <div class="tip">
                    <strong>üí° Tip:</strong> Los rankings se calculan con los √∫ltimos N ex√°menes (puedes elegir cu√°ntos: 2, 3, 5, 10, etc.). 
                    Esto te permite ver tu evoluci√≥n y compararte con otros opositores. Puedes filtrar por tema o municipio 
                    para rankings m√°s espec√≠ficos.
                </div>
            </div>
        </div>
        </div>
    </div>

    {# SECCI√ìN 5: ART√çCULOS #}
    <div class="tutorial-section" id="seccion-5">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-5')">
            <h2><span class="icon-large">üìÑ</span> 5. Art√≠culos</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            Los art√≠culos son recursos de estudio adicionales que pueden ayudarte a entender mejor los temas 
            o estar al d√≠a con novedades relacionadas con las oposiciones.
        </p>
        
        <div class="step-box">
            <strong>Para acceder a los art√≠culos:</strong>
            <ol style="padding-left: 1.5rem;">
                <li>Ve al men√∫ y selecciona "Art√≠culos"</li>
                <li>Ver√°s una lista de todos los art√≠culos disponibles</li>
                <li>Haz clic en un art√≠culo para leerlo completo</li>
                <li>Puedes buscar art√≠culos por t√≠tulo o contenido</li>
            </ol>
        </div>
        
        <div class="feature-card">
            <h4>Tipos de Contenido en Art√≠culos:</h4>
            <ul class="feature-list">
                <li>Explicaciones detalladas de temas complejos</li>
                <li>Informaci√≥n sobre cambios en la legislaci√≥n</li>
                <li>Novedades de las oposiciones</li>
                <li>Consejos de estudio</li>
                <li>Cualquier informaci√≥n relevante para tu preparaci√≥n</li>
            </ul>
        </div>
        
        <div class="tip">
            <strong>üí° Consejo:</strong> Los art√≠culos pueden contener informaci√≥n muy valiosa. 
            Rev√≠salos regularmente para estar al d√≠a y mejorar tu comprensi√≥n de los temas.
        </div>
        </div>
    </div>

    {# SECCI√ìN 6: TEMARIO Y RECURSOS #}
    <div class="tutorial-section" id="seccion-6">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-6')">
            <h2><span class="icon-large">üìö</span> 6. Temario y Recursos</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            En esta secci√≥n encontrar√°s todo el material de estudio organizado por temas. Es tu biblioteca completa 
            de recursos para la preparaci√≥n.
        </p>
        
        <h3>6.1. Temario General (30 Temas)</h3>
        <div class="feature-card">
            <p>
                Aqu√≠ encontrar√°s todos los temas del temario general de las oposiciones. Cada tema puede tener:
            </p>
            <ul class="feature-list">
                <li>PDFs descargables con el contenido completo del tema</li>
                <li>Enlaces a recursos adicionales</li>
                <li>Informaci√≥n sobre el tema</li>
            </ul>
        </div>
        
        <div class="step-box">
            <strong>Para acceder al temario general:</strong>
            <ol style="padding-left: 1.5rem;">
                <li>Ve a "Temario y Recursos"</li>
                <li>En la columna izquierda ver√°s "Temario General (30 Temas)"</li>
                <li>Haz clic en "Ver PDF" junto a cualquier tema para descargarlo o verlo</li>
            </ol>
        </div>
        
        <h3>6.2. Temas Municipales</h3>
        <div class="feature-card">
            <p>
                Si est√°s preparando oposiciones para municipios espec√≠ficos, encontrar√°s temas adicionales 
                relacionados con la normativa y caracter√≠sticas de cada municipio.
            </p>
            <ul class="feature-list">
                <li>Temas organizados por convocatoria</li>
                <li>Temas organizados por municipio</li>
                <li>PDFs descargables de cada tema municipal</li>
                <li>Acceso a todos los municipios de tus convocatorias</li>
            </ul>
        </div>
        
        <div class="step-box">
            <strong>Para acceder a temas municipales:</strong>
            <ol style="padding-left: 1.5rem;">
                <li>Ve a "Temario y Recursos"</li>
                <li>En la columna derecha ver√°s "Temas Municipales"</li>
                <li>Los temas est√°n organizados por convocatoria y municipio</li>
                <li>Haz clic en "Ver PDF" para acceder al contenido</li>
            </ol>
        </div>
        
        <h3>6.3. Ex√°menes PDF</h3>
        <div class="feature-card">
            <p>
                Tambi√©n puedes acceder a ex√°menes en formato PDF que puedes descargar e imprimir para practicar:
            </p>
            <ul class="feature-list">
                <li>Ex√°menes organizados por tema</li>
                <li>Filtrar por tema espec√≠fico</li>
                <li>Descargar e imprimir para pr√°ctica offline</li>
                <li>Ver fecha de subida de cada examen</li>
            </ul>
        </div>
        
        <h3>6.4. Recursos Espec√≠ficos</h3>
        <div class="feature-card">
            <p>
                Tu profesor puede asignarte recursos espec√≠ficos personalizados para ti:
            </p>
            <ul class="feature-list">
                <li>Recursos adicionales seleccionados espec√≠ficamente para ti</li>
                <li>Material complementario</li>
                <li>Enlaces a recursos externos</li>
            </ul>
        </div>
        
        <div class="tip">
            <strong>üí° Consejo:</strong> Combina el estudio del temario con la pr√°ctica de ex√°menes. 
            No solo hagas ex√°menes, dedica tiempo a estudiar los temas en profundidad.
        </div>
        </div>
    </div>

    {# SECCI√ìN 7: BOIB #}
    <div class="tutorial-section" id="seccion-7">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-7')">
            <h2><span class="icon-large">üì∞</span> 7. BOIB (Butllet√≠ Oficial de les Illes Balears)</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            El BOIB es el bolet√≠n oficial donde se publican las leyes y normativas de las Islas Baleares. 
            En la plataforma puedes acceder a informaci√≥n relevante del BOIB relacionada con las oposiciones.
        </p>
        
        <div class="step-box">
            <strong>Para acceder al BOIB:</strong>
            <ol style="padding-left: 1.5rem;">
                <li>Ve al men√∫ y selecciona "BOIB"</li>
                <li>Explora las diferentes secciones disponibles</li>
                <li>Busca informaci√≥n relevante para tu preparaci√≥n</li>
            </ol>
        </div>
        
        <div class="tip">
            <strong>üí° Importante:</strong> El BOIB contiene informaci√≥n oficial sobre normativas y leyes 
            que pueden ser relevantes para las oposiciones. Rev√≠salo peri√≥dicamente para estar al d√≠a.
        </div>
        </div>
    </div>

    {# SECCI√ìN 8: NOTIFICACIONES #}
    <div class="tutorial-section" id="seccion-8">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-8')">
            <h2><span class="icon-large">üîî</span> 8. Notificaciones</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            Las notificaciones te mantienen informado sobre eventos importantes en la plataforma. 
            Recibir√°s notificaciones autom√°ticas cuando ocurran ciertos eventos.
        </p>
        
        <h3>8.1. Acceder a las Notificaciones</h3>
        <div class="step-box">
            <strong>Para ver tus notificaciones:</strong>
            <ol style="padding-left: 1.5rem;">
                <li>Busca el icono üîî en la parte superior derecha del men√∫</li>
                <li>Ver√°s un contador rojo con el n√∫mero de notificaciones no le√≠das</li>
                <li>Haz clic en el icono para ver el men√∫ desplegable de notificaciones</li>
                <li>Haz clic en "Ver todas" para acceder a la p√°gina completa de notificaciones</li>
            </ol>
        </div>
        
        <h3>8.2. Tipos de Notificaciones</h3>
        <div class="feature-card">
            <h4>Notificaciones que puedes recibir:</h4>
            <ul class="feature-list">
                <li><strong>Nuevo examen semanal:</strong> Cuando tu profesor crea un examen semanal disponible para ti</li>
                <li><strong>Nueva planificaci√≥n:</strong> Cuando se crea o modifica tu planificaci√≥n</li>
                <li><strong>Nueva tarea:</strong> Cuando tu profesor te asigna una nueva tarea</li>
                <li><strong>Respuesta a mensaje:</strong> Cuando tu profesor responde a un mensaje que enviaste</li>
                <li><strong>Respuesta a error:</strong> Cuando reportas un error en un art√≠culo o pregunta y recibes respuesta</li>
            </ul>
        </div>
        
        <h3>8.3. Gestionar Notificaciones</h3>
        <div class="feature-card">
            <p>
                En la p√°gina de notificaciones puedes:
            </p>
            <ul class="feature-list">
                <li>Ver todas tus notificaciones (le√≠das y no le√≠das)</li>
                <li>Marcar notificaciones individuales como le√≠das</li>
                <li>Marcar todas las notificaciones como le√≠das</li>
                <li>Ver detalles de cada notificaci√≥n</li>
                <li>Acceder directamente al contenido relacionado (examen, tarea, etc.)</li>
            </ul>
        </div>
        
        <div class="tip">
            <strong>üí° Tip:</strong> Revisa tus notificaciones regularmente para no perderte informaci√≥n importante 
            sobre nuevos ex√°menes, tareas o mensajes de tu profesor.
        </div>
        </div>
    </div>

    {# SECCI√ìN 9: MENSAJES AL PROFESOR #}
    <div class="tutorial-section" id="seccion-9">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-9')">
            <h2><span class="icon-large">üí¨</span> 9. Mensajes al Profesor</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            Puedes comunicarte directamente con tu profesor asignado a trav√©s del sistema de mensajes integrado.
        </p>
        
        <h3>9.1. Enviar un Mensaje</h3>
        <div class="step-box">
            <strong>Para enviar un mensaje a tu profesor:</strong>
            <ol style="padding-left: 1.5rem;">
                <li>Desde el Dashboard, haz clic en "Enviar Mensaje" junto a la informaci√≥n de tu profesor</li>
                <li>O accede directamente desde el men√∫ de mensajes (si est√° disponible)</li>
                <li>Escribe tu mensaje en el formulario</li>
                <li>Env√≠a el mensaje</li>
            </ol>
        </div>
        
        <h3>9.2. Ver el Historial de Mensajes</h3>
        <div class="feature-card">
            <p>
                Puedes ver toda la conversaci√≥n con tu profesor:
            </p>
            <ul class="feature-list">
                <li>Ver todos los mensajes enviados y recibidos</li>
                <li>Ver la fecha y hora de cada mensaje</li>
                <li>Responder a mensajes anteriores</li>
                <li>Mantener un historial completo de la comunicaci√≥n</li>
            </ul>
        </div>
        
        <div class="tip">
            <strong>üí° Consejo:</strong> Usa los mensajes para:
            <ul class="feature-list">
                <li>Resolver dudas sobre temas de estudio</li>
                <li>Pedir aclaraciones sobre tareas o planificaciones</li>
                <li>Informar sobre problemas t√©cnicos</li>
                <li>Cualquier comunicaci√≥n relacionada con tu preparaci√≥n</li>
            </ul>
        </div>
        
        <div class="warning">
            <strong>‚ö†Ô∏è Importante:</strong> Si no tienes profesor asignado, no podr√°s enviar mensajes. 
            Contacta con el administrador para que te asigne un profesor.
        </div>
        </div>
    </div>

    {# SECCI√ìN 10: CONTACTO #}
    <div class="tutorial-section" id="seccion-10">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-10')">
            <h2><span class="icon-large">üìß</span> 10. Contacto</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        <p>
            Si necesitas contactar con el administrador de la plataforma o tienes dudas generales, 
            puedes usar la secci√≥n de contacto.
        </p>
        
        <div class="step-box">
            <strong>Para enviar un mensaje de contacto:</strong>
            <ol style="padding-left: 1.5rem;">
                <li>Ve al men√∫ y selecciona "Contacto"</li>
                <li>Completa el formulario con tu informaci√≥n</li>
                <li>Escribe tu mensaje o consulta</li>
                <li>Env√≠a el mensaje</li>
            </ol>
        </div>
        
        <div class="feature-card">
            <h4>Usa el contacto para:</h4>
            <ul class="feature-list">
                <li>Problemas t√©cnicos con la plataforma</li>
                <li>Dudas sobre el funcionamiento general</li>
                <li>Solicitar ayuda con tu cuenta</li>
                <li>Cualquier consulta general</li>
            </ul>
        </div>
        
        <div class="tip">
            <strong>üí° Diferencia:</strong> Los mensajes al profesor son para temas relacionados con tu preparaci√≥n 
            y estudio.             El contacto es para temas administrativos o t√©cnicos de la plataforma.
        </div>
        </div>
    </div>

    {# SECCI√ìN 11: CONSEJOS Y FAQ #}
    <div class="tutorial-section" id="seccion-11">
        <div class="tutorial-section-header" onclick="toggleSection('seccion-11')">
            <h2><span class="icon-large">üí°</span> 11. Consejos y Preguntas Frecuentes</h2>
            <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="tutorial-section-content">
        
        <h3>11.1. Consejos para Aprovechar la Plataforma</h3>
        
        <div class="feature-card">
            <h4>üìä Sigue tu Progreso</h4>
            <p>
                Revisa regularmente tu historial de ex√°menes y los rankings para ver tu evoluci√≥n. 
                Esto te ayudar√° a identificar tus fortalezas y √°reas de mejora.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>üìÖ Respeta tu Planificaci√≥n</h4>
            <p>
                La planificaci√≥n est√° dise√±ada para optimizar tu tiempo de estudio. Intenta seguirla 
                lo m√°s fielmente posible para obtener los mejores resultados.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>üîÑ Practica Regularmente</h4>
            <p>
                Realiza ex√°menes con frecuencia. La pr√°ctica constante es clave para el √©xito en las oposiciones. 
                Var√≠a entre diferentes dificultades y tipos de ex√°menes.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>üìö Estudia los Temas</h4>
            <p>
                No solo hagas ex√°menes. Dedica tiempo a estudiar los temas, leer los art√≠culos y revisar 
                el material disponible en "Temario y Recursos".
            </p>
        </div>
        
        <div class="feature-card">
            <h4>üí¨ Comun√≠cate con tu Profesor</h4>
            <p>
                Si tienes dudas o necesitas ayuda, no dudes en contactar con tu profesor a trav√©s de los mensajes. 
                Est√°n ah√≠ para ayudarte.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>üîî Revisa tus Notificaciones</h4>
            <p>
                Mantente al d√≠a revisando tus notificaciones regularmente. Te informar√°n sobre nuevos ex√°menes, 
                tareas y mensajes importantes.
            </p>
        </div>
        
        <h3>11.2. Preguntas Frecuentes</h3>
        
        <div class="feature-card">
            <h4>¬øPuedo realizar un examen varias veces?</h4>
            <p>
                S√≠, puedes realizar ex√°menes normales tantas veces como quieras. Los ex√°menes semanales 
                generalmente solo se pueden realizar una vez dentro de su per√≠odo de apertura.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>¬øC√≥mo se calcula la nota?</h4>
            <p>
                La nota se calcula as√≠: cada acierto suma puntos (20 dividido entre el n√∫mero total de preguntas). 
                Cada 4 errores restan el equivalente a 1 acierto. Las preguntas en blanco no suman ni restan.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>¬øQu√© pasa si no tengo profesor asignado?</h4>
            <p>
                Si no tienes profesor asignado, contacta con el administrador. Aunque puedas usar algunas 
                funcionalidades (como ex√°menes normales), muchas caracter√≠sticas (como planificaciones y ex√°menes semanales) 
                requieren un profesor asignado.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>¬øPuedo cambiar mi planificaci√≥n?</h4>
            <p>
                La planificaci√≥n la crea y gestiona tu profesor. Si necesitas ajustes, contacta con √©l 
                a trav√©s de los mensajes.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>¬øLos rankings son p√∫blicos?</h4>
            <p>
                Los rankings muestran tu posici√≥n y tu informaci√≥n, pero los nombres de otros usuarios est√°n 
                ofuscados para proteger la privacidad. Solo t√∫ puedes ver tu nombre completo en los rankings.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>¬øQu√© son los grupos?</h4>
            <p>
                Los grupos son conjuntos de alumnos asignados juntos. Si perteneces a un grupo, puedes ver 
                el historial de ex√°menes del grupo completo y comparar resultados con tus compa√±eros.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>¬øPuedo ver mis ex√°menes anteriores?</h4>
            <p>
                S√≠, en el "Historial de Ex√°menes" puedes ver todos tus ex√°menes anteriores con todos los detalles: 
                preguntas, tus respuestas, respuestas correctas y resultados.
            </p>
        </div>
        
        <div class="feature-card">
            <h4>¬øC√≥mo funcionan las convocatorias?</h4>
            <p>
                Las convocatorias representan procesos de oposici√≥n espec√≠ficos. Si est√°s asignado a una convocatoria, 
                tendr√°s acceso a informaci√≥n sobre fechas de pruebas y recursos espec√≠ficos de esa convocatoria. 
                Los ex√°menes de convocatoria incluyen preguntas de todos los municipios de esa convocatoria.
            </p>
        </div>
        
        <div class="highlight">
            <strong>üéØ Objetivo Final:</strong> La plataforma est√° dise√±ada para acompa√±arte en todo tu proceso 
            de preparaci√≥n. √ösala de forma constante y organizada, y ver√°s c√≥mo mejoras d√≠a a d√≠a. 
            La constancia y el trabajo diario son la clave del √©xito.
        </div>
        </div>
    </div>

</div>

<script>
function toggleSection(sectionId) {
    const section = document.getElementById(sectionId);
    if (section) {
        section.classList.toggle('active');
    }
}

function toggleSubsection(subsectionId) {
    const subsection = document.getElementById(subsectionId);
    if (subsection) {
        subsection.classList.toggle('active');
    }
}

function openSection(sectionId) {
    const section = document.getElementById(sectionId);
    if (section) {
        if (!section.classList.contains('active')) {
            section.classList.add('active');
        }
        // Scroll suave a la secci√≥n
        section.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
}

function toggleAllSections() {
    const sections = document.querySelectorAll('.tutorial-section');
    const subsections = document.querySelectorAll('.subsection');
    const allExpanded = Array.from(sections).every(s => s.classList.contains('active'));
    
    sections.forEach(section => {
        if (allExpanded) {
            section.classList.remove('active');
        } else {
            section.classList.add('active');
        }
    });
    
    // Tambi√©n expandir/colapsar todas las subsecciones
    subsections.forEach(subsection => {
        if (allExpanded) {
            subsection.classList.remove('active');
        } else {
            subsection.classList.add('active');
        }
    });
}

// Funci√≥n para manejar eventos t√°ctiles y clics
function setupAccordionHandlers() {
    // Secciones principales
    document.querySelectorAll('.tutorial-section-header').forEach(header => {
        // Prevenir doble activaci√≥n
        let isHandling = false;
        let touchStartTime = 0;
        
        const handleToggle = (e) => {
            // En m√≥vil, verificar que no sea un scroll
            if (e.type === 'touchend') {
                const touchDuration = Date.now() - touchStartTime;
                if (touchDuration > 300) return; // Probablemente un scroll
            }
            
            if (isHandling) return;
            isHandling = true;
            
            e.preventDefault();
            e.stopPropagation();
            
            const section = header.closest('.tutorial-section');
            if (section) {
                const sectionId = section.id;
                toggleSection(sectionId);
            }
            
            setTimeout(() => {
                isHandling = false;
            }, 300);
        };
        
        // Capturar inicio del touch
        header.addEventListener('touchstart', (e) => {
            touchStartTime = Date.now();
        }, { passive: true });
        
        // A√±adir listeners para compatibilidad
        header.addEventListener('click', handleToggle, { passive: false });
        header.addEventListener('touchend', handleToggle, { passive: false });
    });
    
    // Subsecciones
    document.querySelectorAll('.subsection-header').forEach(header => {
        let isHandling = false;
        let touchStartTime = 0;
        
        const handleToggle = (e) => {
            if (e.type === 'touchend') {
                const touchDuration = Date.now() - touchStartTime;
                if (touchDuration > 300) return;
            }
            
            if (isHandling) return;
            isHandling = true;
            
            e.preventDefault();
            e.stopPropagation();
            
            const subsection = header.closest('.subsection');
            if (subsection) {
                const subsectionId = subsection.id;
                toggleSubsection(subsectionId);
            }
            
            setTimeout(() => {
                isHandling = false;
            }, 300);
        };
        
        header.addEventListener('touchstart', (e) => {
            touchStartTime = Date.now();
        }, { passive: true });
        
        header.addEventListener('click', handleToggle, { passive: false });
        header.addEventListener('touchend', handleToggle, { passive: false });
    });
}

// Abrir la primera secci√≥n por defecto al cargar
document.addEventListener('DOMContentLoaded', function() {
    const firstSection = document.getElementById('seccion-1');
    if (firstSection) {
        firstSection.classList.add('active');
    }
    
    // Configurar handlers para m√≥vil
    setupAccordionHandlers();
});
</script>
{% endblock %}
